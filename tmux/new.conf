# after 2.1

#enable mouse support
set -g mouse on

# two level mappings (i.e. <prefix>g<key>) for selecting different sessions
bind-key s switch-client -T session-select

bind-key -T session-select \; command-prompt 'new-session -As %%'
bind-key -T session-select s choose-tree -sN
bind-key -T session-select 0 run-shell "~/dotfiles/tmux/goto-ith-session 0"
bind-key -T session-select 1 run-shell "~/dotfiles/tmux/goto-ith-session 1"
bind-key -T session-select 2 run-shell "~/dotfiles/tmux/goto-ith-session 2"
bind-key -T session-select 3 run-shell "~/dotfiles/tmux/goto-ith-session 3"
bind-key -T session-select 4 run-shell "~/dotfiles/tmux/goto-ith-session 4"
bind-key -T session-select 5 run-shell "~/dotfiles/tmux/goto-ith-session 5"
bind-key -T session-select 6 run-shell "~/dotfiles/tmux/goto-ith-session 6"
bind-key -T session-select 7 run-shell "~/dotfiles/tmux/goto-ith-session 7"
bind-key -T session-select 8 run-shell "~/dotfiles/tmux/goto-ith-session 8"
bind-key -T session-select 9 run-shell "~/dotfiles/tmux/goto-ith-session 9"
bind-key -T session-select d\
    if-shell 'tmux has-session -t dots'\
        'new-session -As dots'\
        'new-session -As dots -c ~/dotfiles ; run-shell "~/dotfiles/scripts/tmuxlayout.sh dots"'
bind-key -T session-select m\
    if-shell 'type cmus &> /dev/null'\
        'new-session -As music "~/dotfiles/scripts/start-cmus.sh"'\
        'new-session -As music ; display-message "cmus command not found"'
bind-key -T session-select r\
    if-shell 'type rtorrent &> /dev/null'\
        'new-session -As rtorrent "rtorrent"'\
        'new-session -As rtorrent ; display-message "rtorrent command not found"'
bind-key -T session-select b\
    if-shell '[ -f ~/gotowork.sh ]'\
        'new-session -As bop "~/gotowork.sh"'\
        'new-session -As bop ; display-message "~/gotowork.sh not found"'
bind-key -T session-select t\
    if-shell '[ -f ~/gototsar.sh ]'\
        'new-session -As tsar "~/gototsar.sh"'\
        'new-session -As tsar ; display-message "~/gototsar.sh not found"'
bind-key -T session-select o\
    if-shell '[ -f ~/goto1+.sh ]'\
        'new-session -As 1+ "~/goto1+.sh"'\
        'new-session -As 1+ ; display-message "~/goto1+.sh not found"'
bind-key -T session-select + run-shell 'echo #S > /tmp/tmux-marked-session'
bind-key -T session-select x if-shell\
    'tmux has-session -t $(cat /tmp/tmux-marked-session)'\
    'run-shell "tmux switch-client -t $(cat /tmp/tmux-marked-session)"'\
    'display-message "No selected session, select session with <prefix>g+"'

# cmus remote control
bind-key m switch-client -T cmus-remote

bind-key -T cmus-remote z       run-shell '~/dotfiles/tmux/cmus-remote "--prev"'
bind-key -T cmus-remote k       run-shell '~/dotfiles/tmux/cmus-remote "--prev"'
bind-key -T cmus-remote x       run-shell '~/dotfiles/tmux/cmus-remote "--play"'
bind-key -T cmus-remote c       run-shell '~/dotfiles/tmux/cmus-remote "--pause"'
bind-key -T cmus-remote Space   run-shell '~/dotfiles/tmux/cmus-remote "--pause"'
bind-key -T cmus-remote v       run-shell '~/dotfiles/tmux/cmus-remote "--stop"'
bind-key -T cmus-remote b       run-shell '~/dotfiles/tmux/cmus-remote "--next"'
bind-key -T cmus-remote j       run-shell '~/dotfiles/tmux/cmus-remote "--next"'

bind-key -r -T cmus-remote .    run-shell '~/dotfiles/tmux/cmus-remote "--seek +1m"'
bind-key -r -T cmus-remote l    run-shell '~/dotfiles/tmux/cmus-remote "--seek +5"'
bind-key -r -T cmus-remote ,    run-shell '~/dotfiles/tmux/cmus-remote "--seek -1m"'
bind-key -r -T cmus-remote h    run-shell '~/dotfiles/tmux/cmus-remote "--seek -5"'
bind-key -r -T cmus-remote -    run-shell '~/dotfiles/tmux/cmus-remote volume -'
bind-key -r -T cmus-remote +    run-shell '~/dotfiles/tmux/cmus-remote volume +'

bind-key -T cmus-remote m       run-shell '~/dotfiles/tmux/cmus-remote "-C \"toggle aaa_mode\""'
bind-key -T cmus-remote o       run-shell '~/dotfiles/tmux/cmus-remote "-C \"toggle play_sorted\""'
bind-key -T cmus-remote M       run-shell '~/dotfiles/tmux/cmus-remote "-C \"toggle play_library\""'
bind-key -T cmus-remote C-r     run-shell '~/dotfiles/tmux/cmus-remote "-C \"toggle repeat_current\""'

bind-key -T cmus-remote C       run-shell '~/dotfiles/tmux/cmus-remote "-C \"toggle continue\""'
bind-key -T cmus-remote f       run-shell '~/dotfiles/tmux/cmus-remote "-C \"toggle follow\""'
bind-key -T cmus-remote r       run-shell '~/dotfiles/tmux/cmus-remote "--repeat"'
bind-key -T cmus-remote s       run-shell '~/dotfiles/tmux/cmus-remote "--shuffle"'

bind-key -T cmus-remote T       run-shell '~/dotfiles/tmux/cmus-mode settings'
bind-key -T cmus-remote R       run-shell '~/dotfiles/tmux/cmus-mode remote'
bind-key -T cmus-remote u       run-shell 'rm -f /tmp/tmux-powerline_$USER/cmus_remote.txt'

bind-key -T cmus-remote y       run-shell '~/dotfiles/tmux/cmus-remote "add-to-playlist"'

bind-key o switch-client -T open-pane
bind-key -T open-pane p     split-window -v 'ipython3'
bind-key -T open-pane \;    command-prompt 'split-window -v "%%; read _"'

bind-key C-m send-keys -t .{bottom-right} C-p C-m
bind-key C-c send-keys -t .{bottom-right} C-p C-c
